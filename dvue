#### DEVOPS -  EDWIN ARIZA
#### FACILITANDO EL DESPLIEGUE DE APLICACIONES VUE.
if [[ $1 != "" ]]
then
    echo "Enter PATH"
    cd $1/
    FILE=.gitmodules
    # VERIFICAMOS SI EL REPOSITORIO TIENE SUBMODULE.
    if test -f "$FILE"
    then
        echo "Changing routes HTTPS to SSH"
        perl -i -p -e 's|https://(.*?)/|git@\1:|g' $FILE
        git submodule init
        git submodule update
        if [[ $2 != "" ]]
        then
            BRANCH=$2
            echo "Include pull origin $BRANCH"
            git submodule foreach git pull origin $BRANCH
        fi
    fi
    cd src/
    # LIMPIAMOS LOS ARCHIVOS Y CARPETAS CLAVE DE NODE O VUE
    rm -rf node_modules
    rm -rf dist
    npm install --save
    npm audit fix
    npm fund
    npm run build
    rm -rf node_modules
    cd ../../
fi
exit