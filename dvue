#### DEVOPS -  EDWIN ARIZA
#### FACILITANDO EL DESPLIEGUE DE APLICACIONES VUE.
echo "VUE - START"
if [[ $1 != "" ]]
then
    cd $1/
    FILE=.gitmodules
    # SUBMODULES VALIDATION.
    if test -f "$FILE"
        then
            echo "Changing routes HTTPS to SSH"
            perl -i -p -e 's|https://(.*?)/|git@\1:|g' $FILE
            git submodule init
            git submodule update --remote --merge
        fi
    # BRANCH SELECTION
    if [[ $2 != "" ]]
        then
            BRANCH=$2
            echo "Include pull origin $BRANCH"
            git checkout $BRANCH
            git pull origin $BRANCH
        fi
    cd src/
    # LIMPIAMOS LOS ARCHIVOS Y CARPETAS CLAVE DE NODE O VUE
    rm -rf node_modules
    rm -rf dist
    npm install --save
    set -e
    npm run build
    rm -rf node_modules
    cd ../../
fi
exit
